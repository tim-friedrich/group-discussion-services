angular.module('discussionEdit').controller 'DiscussionEditController', ["$scope", "$http", "$filter", ($scope, $http, $filter) ->
  $scope.users = []
  $scope.displayedUsers = []
  $scope.minAge = 0
  $scope.maxAge = 100
  $scope.itemsByPage = 15
  $scope.ageSlider = [0, 100]
  $scope.discussion_id = $('#edit_discussion').data('discussion-id')
  $scope.genders = ['male', 'female', 'other']
  $('[data-toggle="popover"]').popover()
  $('[data-toggle="popover"]').mouseenter((event)->
    $(event.target).popover('show')
  )
  $('[data-toggle="popover"]').mouseleave((event)->
    $(event.target).popover('hide')
  )
  $('.invite').click((e)->
    e.preventDefault()
    )

  $scope.postNewProband = (id) ->
    $.ajax(
      type: "POST",
      url: "/discussions_users",
      data:
        discussions_user:
          user_id: id
          discussion_id: $scope.discussion_id
      dataType: 'json'
      )
    console.log("invited User")

  $http.get("/users", headers:{ Accept:'application/json' }).success((data, status, headers, config) =>
    $scope.users = data
    $scope.displayedUsers = [].concat($scope.users)
  ).error((data, status, headers, config) ->
    console.log('error retrieving users')
  )
]
